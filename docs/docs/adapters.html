<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Http Adapters | Caliban</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/caliban/caliban.png">
    <meta name="description" content="Functional GraphQL library for Scala">
    
    <link rel="preload" href="/caliban/assets/css/0.styles.dbcf23bf.css" as="style"><link rel="preload" href="/caliban/assets/js/app.0a13ca96.js" as="script"><link rel="preload" href="/caliban/assets/js/2.5fc29765.js" as="script"><link rel="preload" href="/caliban/assets/js/10.58168a19.js" as="script"><link rel="prefetch" href="/caliban/assets/js/11.72ebed11.js"><link rel="prefetch" href="/caliban/assets/js/12.8a5cfbaf.js"><link rel="prefetch" href="/caliban/assets/js/13.b35844e1.js"><link rel="prefetch" href="/caliban/assets/js/14.60e1901b.js"><link rel="prefetch" href="/caliban/assets/js/15.aedfeabd.js"><link rel="prefetch" href="/caliban/assets/js/16.99127a8f.js"><link rel="prefetch" href="/caliban/assets/js/17.4cc130a0.js"><link rel="prefetch" href="/caliban/assets/js/18.a8ab81c9.js"><link rel="prefetch" href="/caliban/assets/js/19.cd26fd99.js"><link rel="prefetch" href="/caliban/assets/js/20.8d9f66f1.js"><link rel="prefetch" href="/caliban/assets/js/21.71474915.js"><link rel="prefetch" href="/caliban/assets/js/22.e5d355a5.js"><link rel="prefetch" href="/caliban/assets/js/23.14313c30.js"><link rel="prefetch" href="/caliban/assets/js/24.83421dbe.js"><link rel="prefetch" href="/caliban/assets/js/25.3adb7e28.js"><link rel="prefetch" href="/caliban/assets/js/26.8cdc4624.js"><link rel="prefetch" href="/caliban/assets/js/27.94bf6212.js"><link rel="prefetch" href="/caliban/assets/js/28.b6eee99e.js"><link rel="prefetch" href="/caliban/assets/js/3.25ff5963.js"><link rel="prefetch" href="/caliban/assets/js/4.7a20f468.js"><link rel="prefetch" href="/caliban/assets/js/5.d6b6314a.js"><link rel="prefetch" href="/caliban/assets/js/6.b7624161.js"><link rel="prefetch" href="/caliban/assets/js/7.d6546fdb.js"><link rel="prefetch" href="/caliban/assets/js/8.969e7e3b.js"><link rel="prefetch" href="/caliban/assets/js/9.9f2d23ab.js">
    <link rel="stylesheet" href="/caliban/assets/css/0.styles.dbcf23bf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/caliban/" class="home-link router-link-active"><img src="/caliban/caliban.svg" alt="Caliban" class="logo"> <span class="site-name can-hide">Caliban</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/caliban/docs/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/caliban/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/caliban/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/caliban/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="https://github.com/ghostdogpr/caliban" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://javadoc.io/doc/com.github.ghostdogpr/caliban_2.12/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Scaladoc
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/caliban/docs/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/caliban/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/caliban/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/caliban/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="https://github.com/ghostdogpr/caliban" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://javadoc.io/doc/com.github.ghostdogpr/caliban_2.12/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Scaladoc
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Caliban Server</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/caliban/docs/" aria-current="page" class="sidebar-link">Getting Started</a></li><li><a href="/caliban/docs/schema.html" class="sidebar-link">Schemas</a></li><li><a href="/caliban/docs/middleware.html" class="sidebar-link">Middleware</a></li><li><a href="/caliban/docs/optimization.html" class="sidebar-link">Query optimization</a></li><li><a href="/caliban/docs/validation.html" class="sidebar-link">Validation</a></li><li><a href="/caliban/docs/introspection.html" class="sidebar-link">Introspection</a></li><li><a href="/caliban/docs/adapters.html" aria-current="page" class="active sidebar-link">Http Adapters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/caliban/docs/adapters.html#built-in-adapters" class="sidebar-link">Built-in adapters</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/adapters.html#make-your-own-adapter" class="sidebar-link">Make your own adapter</a></li></ul></li><li><a href="/caliban/docs/interop.html" class="sidebar-link">Interop</a></li><li><a href="/caliban/docs/federation.html" class="sidebar-link">Federation</a></li><li><a href="/caliban/docs/relay-connections.html" class="sidebar-link">Relay Connections</a></li><li><a href="/caliban/docs/schema-reporting.html" class="sidebar-link">Schema Reporting</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Caliban Client</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Caliban Tools</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/caliban/docs/examples.html" class="sidebar-link">Examples</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="http-adapters"><a href="#http-adapters" class="header-anchor">#</a> Http Adapters</h1> <p>Once you have an interpreter able to execute GraphQL queries, you usually want to expose it using an HTTP API.
Caliban comes with a few &quot;ready-to-use&quot; components (called &quot;adapters&quot;) to expose your API with the most popular HTTP libraries.</p> <p>Under the hood, adapters use the <a href="https://tapir.softwaremill.com/en/latest/" target="_blank" rel="noopener noreferrer">tapir<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> library, so you can easily create a custom adapter with anything that tapir supports.</p> <h2 id="built-in-adapters"><a href="#built-in-adapters" class="header-anchor">#</a> Built-in adapters</h2> <p>Each built-in adapter comes with 3 main functions:</p> <ul><li><code>makeHttpService</code> takes an interpreter and turns it into a route following the <a href="https://graphql.org/learn/serving-over-http/#http-methods-headers-and-body" target="_blank" rel="noopener noreferrer">standard GraphQL protocol<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>makeHttpUploadService</code> takes an interpreter and turns it into a route following the <a href="https://github.com/jaydenseric/graphql-multipart-request-spec" target="_blank" rel="noopener noreferrer">GraphQL multipart request protocol<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>makeWebSocketService</code> takes an interpreter and turns it into a route following the <a href="https://github.com/enisdenjo/graphql-ws/blob/master/PROTOCOL.md" target="_blank" rel="noopener noreferrer">GraphQL WebSocket protocol<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>Each of these functions also support a few parameters:</p> <ul><li><code>skipValidation</code> (default: false) allows skipping validation when executing requests</li> <li><code>enableIntrospection</code> (default: true) allows disabling introspection</li> <li><code>queryExecution</code> (default: Parallel) defines how query optimization should work</li> <li><code>requestInterceptor</code> (default: empty) allows intercepting data from the request (e.g. headers) and do something with it (e.g. save it inside ZIO env)</li> <li><code>webSocketHooks</code> (default: empty) gives you some hooks around the WebSocket lifecycle (useful for authentication)</li></ul> <p>The following adapters are provided:</p> <ul><li><code>Http4sAdapter</code> exposes a route for http4s, using circe for the Json handling.</li> <li><code>ZHttpAdapter</code> exposes a route for zio-http, using circe for the Json handling. This one doesn't support upload yet.</li> <li><code>PlayHttpAdapter</code> exposes a route for play, using play-json for the Json handling.</li> <li><code>AkkaHttpAdapter</code> exposes a route for akka. For historical reasons, this adapter is not fixed to any Json library, which means that you need depend on one of the tapir Json libraries and import it.</li></ul> <p>Want to use something else? Want to use one of them with a different Json library? Check the next section!</p> <p>Make sure to check the <a href="/caliban/docs/examples.html">examples</a> to see the adapters in action.</p> <h2 id="make-your-own-adapter"><a href="#make-your-own-adapter" class="header-anchor">#</a> Make your own adapter</h2> <p>All existing adapters are actually using a common adapter under the hood, called <code>TapirAdapter</code>.</p> <p>This adapter, available in the <code>caliban-tapir</code> dependency, also have the same 3 methods <code>makeHttpService</code>, <code>makeHttpUploadService</code> and <code>makeWebSocketService</code>.
There are 2 main differences between these and the methods from the built-in adapters:</p> <ul><li>they return one or several tapir <code>ServerEndpoint</code>, which you can then pass to a tapir interpreter. The returned <code>ServerEndpoint</code> use <code>RIO[R, *]</code> as an effect type, but you can easily transform it to another effect type. A helper <code>convertHttpEndpointToFuture</code> allows converting the effect type to a scala <code>Future</code> (this is used in the Akka and Play interpreters).</li> <li>they require some implicit <code>JsonCodec</code>, which you can get by importing the proper tapir json object</li></ul> <p>Let's say we want to use http4s but with play-json instead of circe. The built-in <code>Http4sAdapter</code> uses circe so instead, we will directly use <code>TapirAdapter</code>.
First, we need to import 2 tapir dependencies in our project (in addition to <code>caliban-tapir</code>):</p> <ul><li>a tapir interpreter for http4s: <code>tapir-zio-http4s-server</code></li> <li>a tapir json codec for play-json: <code>tapir-json-play</code></li></ul> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">sttp<span class="token punctuation">.</span>tapir<span class="token punctuation">.</span>json<span class="token punctuation">.</span>play<span class="token punctuation">.</span></span>_
<span class="token keyword">import</span> <span class="token namespace">sttp<span class="token punctuation">.</span>tapir<span class="token punctuation">.</span>server<span class="token punctuation">.</span>http4s<span class="token punctuation">.</span>ztapir<span class="token punctuation">.</span></span>ZHttp4sServerInterpreter

<span class="token keyword">val</span> endpoints   <span class="token operator">=</span> TapirAdapter<span class="token punctuation">.</span>makeHttpService<span class="token punctuation">(</span>interpreter<span class="token punctuation">)</span>
<span class="token keyword">val</span> http4sRoute <span class="token operator">=</span> ZHttp4sServerInterpreter<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>from<span class="token punctuation">(</span>endpoints<span class="token punctuation">)</span><span class="token punctuation">.</span>toRoutes
</code></pre></div><p>That's it! <code>http4sRoute</code> is a valid http4s route ready to serve our API.</p> <div class="custom-block tip"><p class="custom-block-title">Limitations</p> <p>The zio-http interpreter in tapir does not include multipart and websocket support.</p> <p>Caliban comes with json encoders and decoders for circe, zio-json and play-json.
If you use another json library, you will need to create encoders and decoders for it (which is very simple, you can simply look at the existing ones).</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/caliban/docs/introspection.html" class="prev">
        Introspection
      </a></span> <span class="next"><a href="/caliban/docs/interop.html">
        Interop
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/caliban/assets/js/app.0a13ca96.js" defer></script><script src="/caliban/assets/js/2.5fc29765.js" defer></script><script src="/caliban/assets/js/10.58168a19.js" defer></script>
  </body>
</html>

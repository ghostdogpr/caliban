<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Http Adapters | Caliban</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/caliban/caliban.png">
    <meta name="description" content="Functional GraphQL library for Scala">
    
    <link rel="preload" href="/caliban/assets/css/0.styles.b5ed6211.css" as="style"><link rel="preload" href="/caliban/assets/js/app.01dcb3c3.js" as="script"><link rel="preload" href="/caliban/assets/js/2.778bb4ad.js" as="script"><link rel="preload" href="/caliban/assets/js/1.f8bb34da.js" as="script"><link rel="preload" href="/caliban/assets/js/25.9a078823.js" as="script"><link rel="prefetch" href="/caliban/assets/js/10.fde088a2.js"><link rel="prefetch" href="/caliban/assets/js/11.c62b6b34.js"><link rel="prefetch" href="/caliban/assets/js/12.27d4f152.js"><link rel="prefetch" href="/caliban/assets/js/13.3f3f6a36.js"><link rel="prefetch" href="/caliban/assets/js/14.eb7a3d07.js"><link rel="prefetch" href="/caliban/assets/js/15.114dfd5c.js"><link rel="prefetch" href="/caliban/assets/js/16.85253907.js"><link rel="prefetch" href="/caliban/assets/js/17.c2838453.js"><link rel="prefetch" href="/caliban/assets/js/18.3256f17f.js"><link rel="prefetch" href="/caliban/assets/js/19.d8afd0ae.js"><link rel="prefetch" href="/caliban/assets/js/20.0d880388.js"><link rel="prefetch" href="/caliban/assets/js/21.33b300c9.js"><link rel="prefetch" href="/caliban/assets/js/22.b7c97fbe.js"><link rel="prefetch" href="/caliban/assets/js/23.cd7748bf.js"><link rel="prefetch" href="/caliban/assets/js/24.6c1d1f02.js"><link rel="prefetch" href="/caliban/assets/js/26.48268e8d.js"><link rel="prefetch" href="/caliban/assets/js/27.766da316.js"><link rel="prefetch" href="/caliban/assets/js/28.d0ed8364.js"><link rel="prefetch" href="/caliban/assets/js/29.7748e0b8.js"><link rel="prefetch" href="/caliban/assets/js/3.af33e5d6.js"><link rel="prefetch" href="/caliban/assets/js/30.fbe96632.js"><link rel="prefetch" href="/caliban/assets/js/31.86d5b347.js"><link rel="prefetch" href="/caliban/assets/js/32.661e0812.js"><link rel="prefetch" href="/caliban/assets/js/33.a40e1906.js"><link rel="prefetch" href="/caliban/assets/js/34.8425abc5.js"><link rel="prefetch" href="/caliban/assets/js/35.0a127519.js"><link rel="prefetch" href="/caliban/assets/js/36.f041aa27.js"><link rel="prefetch" href="/caliban/assets/js/37.6adbf9e3.js"><link rel="prefetch" href="/caliban/assets/js/38.10c15a61.js"><link rel="prefetch" href="/caliban/assets/js/39.f57441bb.js"><link rel="prefetch" href="/caliban/assets/js/4.45665f8a.js"><link rel="prefetch" href="/caliban/assets/js/40.53ae918a.js"><link rel="prefetch" href="/caliban/assets/js/41.c8ca9cc1.js"><link rel="prefetch" href="/caliban/assets/js/42.99036692.js"><link rel="prefetch" href="/caliban/assets/js/43.1b6ac9b5.js"><link rel="prefetch" href="/caliban/assets/js/44.e00ae25b.js"><link rel="prefetch" href="/caliban/assets/js/5.7098d77a.js"><link rel="prefetch" href="/caliban/assets/js/6.0c0a0f39.js"><link rel="prefetch" href="/caliban/assets/js/7.6a854e57.js"><link rel="prefetch" href="/caliban/assets/js/vendors~docsearch.5e19b665.js">
    <link rel="stylesheet" href="/caliban/assets/css/0.styles.b5ed6211.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/caliban/" class="home-link router-link-active"><img src="/caliban/caliban.svg" alt="Caliban" class="logo"> <span class="site-name can-hide">Caliban</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/caliban/docs/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/caliban/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/caliban/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/caliban/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="https://github.com/ghostdogpr/caliban" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://javadoc.io/doc/com.github.ghostdogpr/caliban_2.12/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Scaladoc
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/caliban/docs/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/caliban/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/caliban/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/caliban/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="https://github.com/ghostdogpr/caliban" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://javadoc.io/doc/com.github.ghostdogpr/caliban_2.12/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Scaladoc
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Caliban Server</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/caliban/docs/" aria-current="page" class="sidebar-link">Getting Started</a></li><li><a href="/caliban/docs/schema.html" class="sidebar-link">Schemas</a></li><li><a href="/caliban/docs/middleware.html" class="sidebar-link">Middleware</a></li><li><a href="/caliban/docs/optimization.html" class="sidebar-link">Query optimization</a></li><li><a href="/caliban/docs/validation.html" class="sidebar-link">Validation</a></li><li><a href="/caliban/docs/introspection.html" class="sidebar-link">Introspection</a></li><li><a href="/caliban/docs/adapters.html" aria-current="page" class="active sidebar-link">Http Adapters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/caliban/docs/adapters.html#built-in-tapir-adapters" class="sidebar-link">Built-in tapir adapters</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/adapters.html#json-handling" class="sidebar-link">Json handling</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/adapters.html#make-your-own-adapter" class="sidebar-link">Make your own adapter</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/adapters.html#high-performance-quickadapter" class="sidebar-link">High-performance QuickAdapter</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/caliban/docs/adapters.html#usage" class="sidebar-link">Usage</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/adapters.html#customization" class="sidebar-link">Customization</a></li></ul></li></ul></li><li><a href="/caliban/docs/interop.html" class="sidebar-link">Interop</a></li><li><a href="/caliban/docs/federation.html" class="sidebar-link">Federation</a></li><li><a href="/caliban/docs/relay-connections.html" class="sidebar-link">Relay Connections</a></li><li><a href="/caliban/docs/schema-reporting.html" class="sidebar-link">Schema Reporting</a></li><li><a href="/caliban/docs/server-codegen.html" class="sidebar-link">Server code generation from schema</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Caliban Client</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Caliban Tools</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/caliban/docs/examples.html" class="sidebar-link">Examples</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="http-adapters"><a href="#http-adapters" class="header-anchor">#</a> Http Adapters</h1> <p>Once you have an interpreter able to execute GraphQL queries, you usually want to expose it using an HTTP API.
Caliban comes with a few &quot;ready-to-use&quot; components (called &quot;adapters&quot;) to expose your API with the most popular HTTP libraries.</p> <div class="custom-block tip"><p class="custom-block-title">`QuickAdapter`</p> <p>Starting with v2.4.3, Caliban provides the opinionated <a href="/caliban/docs/adapters.html#high-performance-quickadapter">QuickAdapter</a>
that favours ease-of-use and performance at the expense of customizability.</p> <p>If you want the best possible performance, make sure to check it out!</p></div> <h2 id="built-in-tapir-adapters"><a href="#built-in-tapir-adapters" class="header-anchor">#</a> Built-in tapir adapters</h2> <p>Under the hood, adapters use the <a href="https://tapir.softwaremill.com/en/latest/" target="_blank" rel="noopener noreferrer">tapir<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> library, so you can easily create a custom adapter with anything that tapir supports.</p> <p>The following adapters are provided:</p> <ul><li><code>Http4sAdapter</code> exposes a route for http4s.</li> <li><code>ZHttpAdapter</code> exposes a route for zio-http. This one doesn't support uploads yet.</li> <li><code>PlayHttpAdapter</code> exposes a route for play.</li> <li><code>AkkaHttpAdapter</code> exposes a route for akka.</li> <li><code>PekkoHttpAdapter</code> exposes a route for pekko.</li></ul> <p>To use them, you first need to transform your <code>GraphQLInterpreter</code> into a new type of interpreter that supports the protocol you want to use.
There are 3 of them:</p> <ul><li><code>HttpInterpreter</code> follows the <a href="https://graphql.org/learn/serving-over-http/#http-methods-headers-and-body" target="_blank" rel="noopener noreferrer">standard GraphQL protocol<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>HttpUploadInterpreter</code> follows the <a href="https://github.com/jaydenseric/graphql-multipart-request-spec" target="_blank" rel="noopener noreferrer">GraphQL multipart request protocol<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>WebSocketInterpreter</code> follows the <a href="https://github.com/enisdenjo/graphql-ws/blob/master/PROTOCOL.md" target="_blank" rel="noopener noreferrer">GraphQL WebSocket protocol<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>These interpreters expose 2 powerful methods:</p> <ul><li><code>configure</code> takes a <code>Configurator[R]</code> which is an alias for <code>URIO[R &amp; Scope, Unit]</code>.
It allows configuring the interpreter by running an effect that will run for each request and that can modify the configuration of the running fiber. Built-in configurators such as <code>Configurator.setSkipValidation</code>, <code>Configurator.setEnableIntrospection</code> and <code>Configurator.setQueryExecution</code> let you dynamically change the configuration of the interpreter.</li> <li><code>intercept</code> takes an <code>Interceptor[-R1, +R]</code> which is an alias for <code>ZLayer[R1 &amp; ServerRequest, TapirResponse, R]</code>.
It is basically a more powerful version of <code>configure</code> that gives you access to the incoming request (<code>ServerRequest</code>) and lets you modify the environment of the interpreter (from <code>R</code> to <code>R1</code>). A typical use case would be to extract an authentication token from the request and eliminate the authentication requirement from the environment if the token is valid. See an example <a href="https://github.com/ghostdogpr/caliban/blob/series/2.x/examples/src/main/scala/example/akkahttp/AuthExampleApp.scala#L51" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li></ul> <p>In addition to that, the <code>WebSocketInterpreter</code> constructor comes with 2 optional parameters:</p> <ul><li><code>keepAliveInterval</code> (default: empty) defines the interval for the server to send keep alive messages to the client</li> <li><code>webSocketHooks</code> (default: empty) gives you some hooks around the WebSocket lifecycle (useful for authentication)</li></ul> <p>Once your interpreter is correctly configured, you can use one of these 3 functions exposed by each built-in adapter:</p> <ul><li><code>makeHttpService</code> turns an <code>HttpInterpreter</code> into a route for the corresponding library</li> <li><code>makeHttpUploadService</code> turns an <code>HttpUploadInterpreter</code> into a route for the corresponding library</li> <li><code>makeWebSocketService</code> turns a <code>WebSocketInterpreter</code> into a route for the corresponding library</li></ul> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> graphQLInterpreter<span class="token operator">:</span> GraphQLInterpreter<span class="token punctuation">[</span>AuthToken<span class="token punctuation">,</span> CalibanError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span>
<span class="token comment">// turn our GraphQL interpreter into an HttpInterpreter</span>
<span class="token keyword">val</span> noAuthInterpreter<span class="token operator">:</span> HttpInterpreter<span class="token punctuation">[</span>AuthToken<span class="token punctuation">,</span> CalibanError<span class="token punctuation">]</span> <span class="token operator">=</span> HttpInterpreter<span class="token punctuation">(</span>graphQLInterpreter<span class="token punctuation">)</span>
<span class="token comment">// define authentication logic (from a ServerRequest, fail or build an AuthToken)</span>
<span class="token keyword">val</span> auth<span class="token operator">:</span> ZLayer<span class="token punctuation">[</span>ServerRequest<span class="token punctuation">,</span> TapirResponse<span class="token punctuation">,</span> AuthToken<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span>
<span class="token comment">// pass our interceptor to eliminate the AuthToken requirement from the environment</span>
<span class="token keyword">val</span> authInterpreter<span class="token operator">:</span> HttpUploadInterpreter<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">,</span> CalibanError<span class="token punctuation">]</span> <span class="token operator">=</span> httpInterpreter<span class="token punctuation">.</span>intercept<span class="token punctuation">(</span>auth<span class="token punctuation">)</span>
<span class="token comment">// get our route for Akka Http</span>
<span class="token keyword">val</span> route <span class="token operator">=</span> AkkaHttpAdapter<span class="token punctuation">.</span>default<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>makeHttpService<span class="token punctuation">(</span>authInterpreter<span class="token punctuation">)</span>
</code></pre></div><p>Want to use something else? Check <a href="#make-your-own-adapter">make your own adapter section</a>!</p> <p>Make sure to check the <a href="/caliban/docs/examples.html">examples</a> to see the adapters in action.</p> <h2 id="json-handling"><a href="#json-handling" class="header-anchor">#</a> Json handling</h2> <p>Caliban comes with JSON encoders and decoders for the following libraries:</p> <ul><li>circe</li> <li>jsoniter-scala (JDK 11+ only)</li> <li>play-json</li> <li>zio-json</li></ul> <p>Since v2.1.0, the adapters are not bound to a specific JSON handler and require the user to add the <a href="/caliban/docs/#interop-with-3rd-party-libraries">corresponding dependency</a> in their project and import the implicits in scope when calling the <code>makeHttpService</code> / <code>makeHttpUploadService</code> / <code>makeWebSocketService</code> methods.</p> <p>Let's say we want to use <code>http4s</code> as the server implementation with <code>zio-json</code> as the json handler. Defining the http4s route is as simple as:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> http4sRoute <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> <span class="token namespace">sttp<span class="token punctuation">.</span>tapir<span class="token punctuation">.</span>json<span class="token punctuation">.</span>zio<span class="token punctuation">.</span></span>_
  Http4sAdapter<span class="token punctuation">.</span>makeHttpService<span class="token punctuation">(</span>interpreter<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>That's it! <code>http4sRoute</code> is a valid http4s route ready to serve our API.</p> <p>If you use another json library, you will need to create encoders and decoders for it (which is very simple, you can simply look at the existing ones).
The full list of JSON libraries supported by Tapir can be found <a href="https://tapir.softwaremill.com/en/latest/endpoint/json.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="custom-block tip"><p class="custom-block-title">Known issues: jsoniter-scala</p> <p>The <code>makeHttpUploadService</code> methods require an implicit of <code>JsonCodec[Map[String,Seq[String]]]</code> in scope. Jsoniter does not provide
codecs for common types by default, which means the user needs to create one. To do so, add the <code>jsoniter-scala-macros</code> dependency to your project and create one as:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">sttp<span class="token punctuation">.</span>tapir<span class="token punctuation">.</span>json<span class="token punctuation">.</span>jsoniter<span class="token punctuation">.</span></span>_
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>plokhotnyuk<span class="token punctuation">.</span>jsoniter_scala<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span>_
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>plokhotnyuk<span class="token punctuation">.</span>jsoniter_scala<span class="token punctuation">.</span>macros<span class="token punctuation">.</span></span>_

<span class="token keyword">val</span> http4sRoute <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> <span class="token namespace">sttp<span class="token punctuation">.</span>tapir<span class="token punctuation">.</span>json<span class="token punctuation">.</span>jsoniter<span class="token punctuation">.</span></span>_
  <span class="token keyword">implicit</span> <span class="token keyword">val</span> codec<span class="token operator">:</span> JsonValueCodec<span class="token punctuation">[</span>Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span> Seq<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> JsonCodecMaker<span class="token punctuation">.</span>make

  Http4sAdapter<span class="token punctuation">.</span>makeHttpUploadService<span class="token punctuation">(</span>interpreter<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>To maximize performance, the <strong>jsoniter</strong> codec implementation is stack-recursive. To prevent stack overflow errors, it has a <strong>maximum depth limit of 512</strong>.</p> <p>If your schema contains recursive types and want to use the jsoniter codecs, make sure to also limit the maximum query depth using
the <a href="/caliban/docs/middleware.html#pre-defined-wrappers">maxDepth wrapper</a>.</p></div></div> <h2 id="make-your-own-adapter"><a href="#make-your-own-adapter" class="header-anchor">#</a> Make your own adapter</h2> <p>All existing adapters are actually using a common adapter under the hood, called <code>TapirAdapter</code>.</p> <p>This adapter, available in the <code>caliban-tapir</code> dependency which has the same 3 methods <code>makeHttpService</code>, <code>makeHttpUploadService</code> and <code>makeWebSocketService</code>.</p> <p>The main differences between these and the methods from the built-in adapters is that they return one or several tapir <code>ServerEndpoint</code>,
which you can then pass to a tapir interpreter. The returned <code>ServerEndpoint</code> use <code>RIO[R, *]</code> as an effect type, but you can easily transform it to another effect type. A helper <code>convertHttpEndpointToFuture</code> allows converting the effect type to a scala <code>Future</code> (this is used in the Akka, Pekko, and Play interpreters).</p> <h2 id="high-performance-quickadapter"><a href="#high-performance-quickadapter" class="header-anchor">#</a> High-performance <code>QuickAdapter</code></h2> <p>The <code>QuickAdapter</code> requires minimal setup and uses <a href="https://github.com/zio/zio-http" target="_blank" rel="noopener noreferrer">zio-http<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
and <a href="https://github.com/plokhotnyuk/jsoniter-scala" target="_blank" rel="noopener noreferrer">jsoniter-scala<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> without tapir in order to provide the best possible performance.</p> <h3 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h3> <p>In order to use it, just add the following to your <code>build.sbt</code> file (no other dependencies required!):</p> <div class="language-scala extra-class"><pre class="language-scala"><code>libraryDependencies <span class="token operator">+=</span> <span class="token string">&quot;com.github.ghostdogpr&quot;</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token string">&quot;caliban-quick&quot;</span> <span class="token operator">%</span> <span class="token string">&quot;2.5.2&quot;</span>
</code></pre></div><p>By adding <code>import caliban.quick._</code>, we expose a few convenient extension methods on our <code>GraphQL</code> api.
For example, we can serve our GraphQL api with minimal setup via a single command:</p> <div class="language-scala mdoc:compile-only extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span></span>_
<span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span>quick<span class="token punctuation">.</span></span>_

<span class="token keyword">val</span> api<span class="token operator">:</span> GraphQL<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span>

api<span class="token punctuation">.</span>runServer<span class="token punctuation">(</span>
  port <span class="token operator">=</span> <span class="token number">8080</span><span class="token punctuation">,</span>
  apiPath <span class="token operator">=</span> <span class="token string">&quot;/api/graphql&quot;</span><span class="token punctuation">,</span>
  graphiqlPath <span class="token operator">=</span> Some<span class="token punctuation">(</span><span class="token string">&quot;/graphiql&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  uploadPath <span class="token operator">=</span> Some<span class="token punctuation">(</span><span class="token string">&quot;/upload/graphql&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Optional, for enabling GraphQL uploads</span>
<span class="token punctuation">)</span>
</code></pre></div><p>Alternatively, you can also create a zio-http <code>Handler</code> and manually compose it into an app:</p> <div class="language-scala mdoc:compile-only extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span></span>_
<span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span>quick<span class="token punctuation">.</span></span>_
<span class="token keyword">import</span> <span class="token namespace">zio<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span>_

<span class="token keyword">val</span> api<span class="token operator">:</span> GraphQL<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span>

<span class="token keyword">for</span> <span class="token punctuation">{</span>
    handlers  <span class="token keyword">&lt;-</span> api<span class="token punctuation">.</span>handlers
    <span class="token comment">// Alternatively, without imported syntax:</span>
    handlers2 <span class="token keyword">&lt;-</span> api<span class="token punctuation">.</span>interpreter<span class="token punctuation">.</span>map<span class="token punctuation">(</span>QuickAdapter<span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">.</span>handlers<span class="token punctuation">)</span>
    <span class="token comment">// Creates a handler which serves the GraphiQL API from CDN</span>
    graphiql <span class="token operator">=</span> GraphiQLHandler<span class="token punctuation">.</span>handler<span class="token punctuation">(</span>apiPath <span class="token operator">=</span> <span class="token string">&quot;/api/graphql&quot;</span><span class="token punctuation">,</span> graphiqlPath <span class="token operator">=</span> <span class="token string">&quot;/graphiql&quot;</span><span class="token punctuation">)</span>
    app <span class="token operator">=</span> Routes<span class="token punctuation">(</span>
            Method<span class="token punctuation">.</span>ANY <span class="token operator">/</span> <span class="token string">&quot;api&quot;</span> <span class="token operator">/</span> <span class="token string">&quot;graphql&quot;</span>     <span class="token operator">-&gt;</span> handlers<span class="token punctuation">.</span>api<span class="token punctuation">,</span>
            Method<span class="token punctuation">.</span>GET <span class="token operator">/</span> <span class="token string">&quot;graphiql&quot;</span>            <span class="token operator">-&gt;</span> graphiql<span class="token punctuation">,</span>
            Method<span class="token punctuation">.</span>POST <span class="token operator">/</span> <span class="token string">&quot;upload&quot;</span> <span class="token operator">/</span> <span class="token string">&quot;graphql&quot;</span> <span class="token operator">-&gt;</span> handlers<span class="token punctuation">.</span>upload
            <span class="token comment">// Add more routes, apply middleware, etc.</span>
          <span class="token punctuation">)</span><span class="token punctuation">.</span>toHttpApp
    _ <span class="token keyword">&lt;-</span> Server<span class="token punctuation">.</span>serve<span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span>provide<span class="token punctuation">(</span>Server<span class="token punctuation">.</span>defaultWithPort<span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">yield</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="customization"><a href="#customization" class="header-anchor">#</a> Customization</h3> <p>The <code>QuickAdapter</code> exposes the following methods that allow you to customize the server or apply middleware to the routes:</p> <ul><li><code>configure</code> which takes a <code>Configurator[R]</code> <a href="/caliban/docs/adapters.html#built-in-tapir-adapters">similar to the tapir-based adapters</a></li> <li><code>handlers</code> which returns a <code>QuickHandlers[R]</code> which contains individual handlers to manually construct routes.
Note that this handler is only for the api routes. To construct the graphiql handler use <code>caliban.GraphiQLHandler.handler</code>.</li></ul> <p>For more info on customization and middleware, check out the <a href="https://github.com/ghostdogpr/caliban/tree/series/2.x/examples/src/main/scala/example/quick" target="_blank" rel="noopener noreferrer">adapter examples<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>!</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/caliban/docs/introspection.html" class="prev">
        Introspection
      </a></span> <span class="next"><a href="/caliban/docs/interop.html">
        Interop
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/caliban/assets/js/app.01dcb3c3.js" defer></script><script src="/caliban/assets/js/2.778bb4ad.js" defer></script><script src="/caliban/assets/js/1.f8bb34da.js" defer></script><script src="/caliban/assets/js/25.9a078823.js" defer></script>
  </body>
</html>

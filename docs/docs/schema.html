<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Schemas | Caliban</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/caliban/caliban.png">
    <meta name="description" content="Functional GraphQL library for Scala">
    
    <link rel="preload" href="/caliban/assets/css/0.styles.df97fda4.css" as="style"><link rel="preload" href="/caliban/assets/js/app.31e5e5cd.js" as="script"><link rel="preload" href="/caliban/assets/js/2.63c13255.js" as="script"><link rel="preload" href="/caliban/assets/js/23.2694ff67.js" as="script"><link rel="prefetch" href="/caliban/assets/js/10.7f6d5355.js"><link rel="prefetch" href="/caliban/assets/js/11.b2f83103.js"><link rel="prefetch" href="/caliban/assets/js/12.d882513a.js"><link rel="prefetch" href="/caliban/assets/js/13.32645a7a.js"><link rel="prefetch" href="/caliban/assets/js/14.aedfe3e6.js"><link rel="prefetch" href="/caliban/assets/js/15.93196ec5.js"><link rel="prefetch" href="/caliban/assets/js/16.d7f8d31c.js"><link rel="prefetch" href="/caliban/assets/js/17.92c88250.js"><link rel="prefetch" href="/caliban/assets/js/18.cd8814aa.js"><link rel="prefetch" href="/caliban/assets/js/19.16370490.js"><link rel="prefetch" href="/caliban/assets/js/20.980cee67.js"><link rel="prefetch" href="/caliban/assets/js/21.cb715c2e.js"><link rel="prefetch" href="/caliban/assets/js/22.2b940863.js"><link rel="prefetch" href="/caliban/assets/js/24.559e5ec7.js"><link rel="prefetch" href="/caliban/assets/js/25.82b0c26f.js"><link rel="prefetch" href="/caliban/assets/js/26.28e4b627.js"><link rel="prefetch" href="/caliban/assets/js/27.d1779489.js"><link rel="prefetch" href="/caliban/assets/js/28.40bde8a6.js"><link rel="prefetch" href="/caliban/assets/js/3.00a0a536.js"><link rel="prefetch" href="/caliban/assets/js/4.94733d25.js"><link rel="prefetch" href="/caliban/assets/js/5.2ea06e07.js"><link rel="prefetch" href="/caliban/assets/js/6.8d81f0ec.js"><link rel="prefetch" href="/caliban/assets/js/7.f4ac6e79.js"><link rel="prefetch" href="/caliban/assets/js/8.8a37c73b.js"><link rel="prefetch" href="/caliban/assets/js/9.be4d2b56.js">
    <link rel="stylesheet" href="/caliban/assets/css/0.styles.df97fda4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/caliban/" class="home-link router-link-active"><img src="/caliban/caliban.svg" alt="Caliban" class="logo"> <span class="site-name can-hide">Caliban</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/caliban/docs/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/caliban/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/caliban/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/caliban/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="https://github.com/ghostdogpr/caliban" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://javadoc.io/doc/com.github.ghostdogpr/caliban_2.12/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Scaladoc
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/caliban/docs/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/caliban/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/caliban/faq/" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/caliban/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="https://github.com/ghostdogpr/caliban" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://javadoc.io/doc/com.github.ghostdogpr/caliban_2.12/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Scaladoc
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Caliban Server</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/caliban/docs/" aria-current="page" class="sidebar-link">Getting Started</a></li><li><a href="/caliban/docs/schema.html" aria-current="page" class="active sidebar-link">Schemas</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/caliban/docs/schema.html#enums-unions-interfaces" class="sidebar-link">Enums, unions, interfaces</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/schema.html#arguments" class="sidebar-link">Arguments</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/schema.html#effects" class="sidebar-link">Effects</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/schema.html#annotations" class="sidebar-link">Annotations</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/schema.html#java-8-time-types" class="sidebar-link">Java 8 Time types</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/schema.html#custom-types" class="sidebar-link">Custom types</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/schema.html#code-generation" class="sidebar-link">Code generation</a></li><li class="sidebar-sub-header"><a href="/caliban/docs/schema.html#building-schemas-by-hand" class="sidebar-link">Building Schemas by hand</a></li></ul></li><li><a href="/caliban/docs/middleware.html" class="sidebar-link">Middleware</a></li><li><a href="/caliban/docs/optimization.html" class="sidebar-link">Query optimization</a></li><li><a href="/caliban/docs/validation.html" class="sidebar-link">Validation</a></li><li><a href="/caliban/docs/introspection.html" class="sidebar-link">Introspection</a></li><li><a href="/caliban/docs/adapters.html" class="sidebar-link">Http Adapters</a></li><li><a href="/caliban/docs/interop.html" class="sidebar-link">Interop</a></li><li><a href="/caliban/docs/federation.html" class="sidebar-link">Federation</a></li><li><a href="/caliban/docs/relay-connections.html" class="sidebar-link">Relay Connections</a></li><li><a href="/caliban/docs/schema-reporting.html" class="sidebar-link">Schema Reporting</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Caliban Client</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Caliban Tools</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/caliban/docs/examples.html" class="sidebar-link">Examples</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="schemas"><a href="#schemas" class="header-anchor">#</a> Schemas</h1> <p>A GraphQL schema will be derived automatically at compile-time (no reflection) from the types present in your resolver.
The table below shows how common Scala types are converted to GraphQL types.</p> <table><thead><tr><th>Scala Type</th> <th>GraphQL Type</th></tr></thead> <tbody><tr><td>Boolean</td> <td>Boolean</td></tr> <tr><td>Int</td> <td>Int</td></tr> <tr><td>Float</td> <td>Float</td></tr> <tr><td>Double</td> <td>Float</td></tr> <tr><td>String</td> <td>String</td></tr> <tr><td>java.util.UUID</td> <td>ID</td></tr> <tr><td>Unit</td> <td>Unit (custom scalar)</td></tr> <tr><td>Long</td> <td>Long (custom scalar)</td></tr> <tr><td>BigInt</td> <td>BigInt (custom scalar)</td></tr> <tr><td>BigDecimal</td> <td>BigDecimal (custom scalar)</td></tr> <tr><td>java.time.Instant</td> <td>Instant (custom scalar)</td></tr> <tr><td>java.time.LocalDate</td> <td>LocalDate (custom scalar)</td></tr> <tr><td>java.time.LocalTime</td> <td>LocalTime (custom scalar)</td></tr> <tr><td>java.time.LocalDateTime</td> <td>LocalDateTime (custom scalar)</td></tr> <tr><td>java.time.OffsetDateTime</td> <td>OffsetDateTime (custom scalar)</td></tr> <tr><td>java.time.ZonedDateTime</td> <td>ZonedDateTime (custom scalar)</td></tr> <tr><td>Case Class</td> <td>Object</td></tr> <tr><td>Sealed Trait</td> <td>Enum or Union</td></tr> <tr><td>Option[A]</td> <td>Nullable A</td></tr> <tr><td>List[A]</td> <td>List of A</td></tr> <tr><td>Set[A]</td> <td>List of A</td></tr> <tr><td>Seq[A]</td> <td>List of A</td></tr> <tr><td>Vector[A]</td> <td>List of A</td></tr> <tr><td>A =&gt; B</td> <td>A and B</td></tr> <tr><td>(A, B)</td> <td>Object with 2 fields <code>_1</code> and <code>_2</code></td></tr> <tr><td>Either[A, B]</td> <td>Object with 2 nullable fields <code>left</code> and <code>right</code></td></tr> <tr><td>Map[A, B]</td> <td>List of Object with 2 fields <code>key</code> and <code>value</code></td></tr> <tr><td>ZIO[R, Nothing, A]</td> <td>A</td></tr> <tr><td>ZIO[R, Throwable, A]</td> <td>Nullable A</td></tr> <tr><td>Future[A]</td> <td>Nullable A</td></tr> <tr><td>ZStream[R, Throwable, A]</td> <td>A (subscription) or List of A (query, mutation)</td></tr> <tr><td>Json (from <a href="https://github.com/circe/circe" target="_blank" rel="noopener noreferrer">Circe<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</td> <td>Json (custom scalar, need <code>import caliban.interop.circe.json._</code>)</td></tr> <tr><td>Json (from <a href="https://github.com/playframework/play-json" target="_blank" rel="noopener noreferrer">play-json<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</td> <td>Json (custom scalar, need <code>import caliban.interop.play.json._</code>)</td></tr></tbody></table> <p>See the <a href="#custom-types">Custom Types</a> section to find out how to support your own types.</p> <p>If you want Caliban to support other standard types, feel free to <a href="https://github.com/ghostdogpr/caliban/issues" target="_blank" rel="noopener noreferrer">file an issue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or even a PR.</p> <div class="custom-block warning"><p class="custom-block-title">Schema derivation issues</p> <p>The schema derivation sometimes has some trouble generating schemas with a lot of nested types, or types reused in multiple places.
To deal with this, you can declare schemas for your case classes and sealed traits explicitly:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">implicit</span> <span class="token keyword">val</span> roleSchema      <span class="token operator">=</span> Schema<span class="token punctuation">.</span>gen<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">,</span> Role<span class="token punctuation">]</span>
<span class="token keyword">implicit</span> <span class="token keyword">val</span> characterSchema <span class="token operator">=</span> Schema<span class="token punctuation">.</span>gen<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">,</span> Character<span class="token punctuation">]</span>
</code></pre></div><p>Make sure those implicits are in scope when you call <code>graphQL(...)</code>. This will make derivation's job easier by pre-generating schemas for those classes and re-using them when needed.
This will also improve compilation times and generate less bytecode.</p> <p>In Scala 2, if the derivation fails and you're not sure why, you can also call Magnolia's macro directly by using <code>genMacro</code>.
The compilation will return better error messages in case something is missing:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">implicit</span> <span class="token keyword">val</span> characterSchema <span class="token operator">=</span> Schema<span class="token punctuation">.</span>genMacro<span class="token punctuation">[</span>Character<span class="token punctuation">]</span><span class="token punctuation">.</span>schema
</code></pre></div><p>In Scala 3, derivation doesn't support value classes and opaque types. You can use <code>Schema.genDebug</code> to print the generated code in the console.</p></div> <h2 id="enums-unions-interfaces"><a href="#enums-unions-interfaces" class="header-anchor">#</a> Enums, unions, interfaces</h2> <p>A sealed trait will be converted to a different GraphQL type depending on its content:</p> <ul><li>a sealed trait with only case objects will be converted to an <code>ENUM</code></li> <li>a sealed trait with only case classes will be converted to a <code>UNION</code></li></ul> <p>GraphQL does not support empty objects, so in case a sealed trait mixes case classes and case objects, a union type will be created and the case objects will have a &quot;fake&quot; field named <code>_</code> which is not queryable.</p> <div class="language-scala mdoc:silent extra-class"><pre class="language-scala"><code><span class="token keyword">sealed</span> <span class="token keyword">trait</span> Origin
<span class="token keyword">object</span> Origin <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token keyword">object</span> EARTH <span class="token keyword">extends</span> Origin
  <span class="token keyword">case</span> <span class="token keyword">object</span> MARS  <span class="token keyword">extends</span> Origin
  <span class="token keyword">case</span> <span class="token keyword">object</span> BELT  <span class="token keyword">extends</span> Origin
<span class="token punctuation">}</span>
</code></pre></div><p>The snippet above will produce the following GraphQL type:</p> <div class="language-graphql extra-class"><pre class="language-graphql"><code><span class="token keyword">enum</span> <span class="token class-name">Origin</span> <span class="token punctuation">{</span>
  <span class="token constant">BELT</span>
  <span class="token constant">EARTH</span>
  <span class="token constant">MARS</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Here's an example of union:</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">sealed</span> <span class="token keyword">trait</span> Role
<span class="token keyword">object</span> Role <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token keyword">class</span> Captain<span class="token punctuation">(</span>shipName<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Role
  <span class="token keyword">case</span> <span class="token keyword">class</span> Engineer<span class="token punctuation">(</span>specialty<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Role
  <span class="token keyword">case</span> <span class="token keyword">object</span> Mechanic <span class="token keyword">extends</span> Role
<span class="token punctuation">}</span>
</code></pre></div><p>The snippet above will produce the following GraphQL type:</p> <div class="language-graphql extra-class"><pre class="language-graphql"><code><span class="token keyword">union</span> <span class="token class-name">Role</span> <span class="token operator">=</span> <span class="token property">Captain</span> <span class="token operator">|</span> <span class="token property">Engineer</span> <span class="token operator">|</span> <span class="token property">Mechanic</span>

<span class="token keyword">type</span> <span class="token class-name">Captain</span> <span class="token punctuation">{</span>
  <span class="token attr-name">shipName</span><span class="token punctuation">:</span> <span class="token scalar">String</span><span class="token operator">!</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Engineer</span> <span class="token punctuation">{</span>
  <span class="token attr-name">specialty</span><span class="token punctuation">:</span> <span class="token scalar">String</span><span class="token operator">!</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Mechanic</span> <span class="token punctuation">{</span>
  <span class="token attr-name">_</span><span class="token punctuation">:</span> <span class="token scalar">Boolean</span><span class="token operator">!</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If your type needs to be shared between multiple unions you can use the <code>@GQLValueType</code> annotation to have caliban
proxy to another type beyond the sealed trait.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">case</span> <span class="token keyword">class</span> Pilot<span class="token punctuation">(</span>callSign<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span>

<span class="token keyword">sealed</span> <span class="token keyword">trait</span> Role
<span class="token keyword">object</span> Role <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token keyword">class</span> Captain<span class="token punctuation">(</span>shipName<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Role
  <span class="token keyword">case</span> <span class="token keyword">class</span> Engineer<span class="token punctuation">(</span>specialty<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Role
  
  <span class="token annotation punctuation">@GQLValueType</span>
  <span class="token keyword">case</span> <span class="token keyword">class</span> Proxy<span class="token punctuation">(</span>pilot<span class="token operator">:</span> Pilot<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This will produce the following GraphQL Types:</p> <div class="language-graphql extra-class"><pre class="language-graphql"><code><span class="token keyword">union</span> <span class="token class-name">Role</span> <span class="token operator">=</span> <span class="token property">Captain</span> <span class="token operator">|</span> <span class="token property">Engineer</span> <span class="token operator">|</span> <span class="token property">Pilot</span>

<span class="token keyword">type</span> <span class="token class-name">Captain</span> <span class="token punctuation">{</span>
  <span class="token attr-name">shipName</span><span class="token punctuation">:</span> <span class="token scalar">String</span><span class="token operator">!</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Engineer</span> <span class="token punctuation">{</span>
  <span class="token attr-name">specialty</span><span class="token punctuation">:</span> <span class="token scalar">String</span><span class="token operator">!</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Pilot</span> <span class="token punctuation">{</span>
  <span class="token attr-name">callSign</span><span class="token punctuation">:</span> <span class="token scalar">String</span><span class="token operator">!</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you prefer an <code>Interface</code> instead of a <code>Union</code> type, add the <code>@GQLInterface</code> annotation to your sealed trait.
An interface will be created with all the fields that are common to the case classes extending the sealed trait, as long as they return the same type.</p> <p>If you prefer to have a <code>Union</code> type instead of an <code>Enum</code>, even when the sealed trait contains only objects, add the <code>@GQLUnion</code> annotation.</p> <h2 id="arguments"><a href="#arguments" class="header-anchor">#</a> Arguments</h2> <p>To declare a field that take arguments, create a dedicated case class representing the arguments and make the field a <em>function</em> from this class to the result type.</p> <div class="language-scala mdoc:silent extra-class"><pre class="language-scala"><code><span class="token keyword">case</span> <span class="token keyword">class</span> Character<span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> origin<span class="token operator">:</span> Origin<span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> FilterArgs<span class="token punctuation">(</span>origin<span class="token operator">:</span> Option<span class="token punctuation">[</span>Origin<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> Queries<span class="token punctuation">(</span>characters<span class="token operator">:</span> FilterArgs <span class="token keyword">=&gt;</span> List<span class="token punctuation">[</span>Character<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>The snippet above will produce the following GraphQL type:</p> <div class="language-graphql extra-class"><pre class="language-graphql"><code><span class="token keyword">type</span> <span class="token class-name">Queries</span> <span class="token punctuation">{</span>
  <span class="token attr-name">characters</span><span class="token punctuation">(</span><span class="token attr-name">origin</span><span class="token punctuation">:</span> <span class="token class-name">Origin</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Character</span><span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Caliban provides auto-derivation for common types such as <code>Int</code>, <code>String</code>, <code>List</code>, <code>Option</code>, etc. but you can also support your own types by providing an implicit instance of <code>caliban.schema.ArgBuilder</code>.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>There is no <code>ArgBuilder</code> for tuples. If you have multiple arguments, use a case class containing all of them instead of a tuple.</p></div> <h2 id="effects"><a href="#effects" class="header-anchor">#</a> Effects</h2> <p>Fields can return ZIO effects. This allows you to leverage all the features provided by ZIO: timeouts, retries, access to ZIO environment, memoizing, etc. An effect will be run every time a query requiring the corresponding field is executed.</p> <div class="language-scala mdoc:silent:nest extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">zio<span class="token punctuation">.</span></span>_

<span class="token keyword">type</span> CharacterName <span class="token operator">=</span> <span class="token builtin">String</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> Queries<span class="token punctuation">(</span>characters<span class="token operator">:</span> Task<span class="token punctuation">[</span>List<span class="token punctuation">[</span>Character<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   character<span class="token operator">:</span> CharacterName <span class="token keyword">=&gt;</span> RIO<span class="token punctuation">[</span>Console<span class="token punctuation">,</span> Character<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>If you don't use ZIO environment (<code>R</code> = <code>Any</code>), there is nothing special to do to get it working.</p> <p>If you require a ZIO environment and use Scala 2, you will need to have the content of <code>caliban.schema.GenericSchema[R]</code> for your custom <code>R</code> in scope when you call <code>graphQL(...)</code>.
When you call <code>Schema.gen</code>, make sure to use your environment as the first type parameter.</p> <div class="language-scala mdoc:silent extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span></span>_
<span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span>schema<span class="token punctuation">.</span></span>_

<span class="token keyword">type</span> MyEnv <span class="token operator">=</span> Console 

<span class="token keyword">object</span> schema <span class="token keyword">extends</span> GenericSchema<span class="token punctuation">[</span>MyEnv<span class="token punctuation">]</span>
<span class="token keyword">import</span> <span class="token namespace">schema<span class="token punctuation">.</span></span>_

<span class="token keyword">implicit</span> <span class="token keyword">val</span> queriesSchema<span class="token operator">:</span> Schema<span class="token punctuation">[</span>MyEnv<span class="token punctuation">,</span> Queries<span class="token punctuation">]</span> <span class="token operator">=</span> Schema<span class="token punctuation">.</span>gen
<span class="token comment">// or</span>
<span class="token comment">// implicit val queriesSchema = Schema.gen[MyEnv, Queries]</span>
</code></pre></div><p>If you require a ZIO environment and use Scala 3, things are simpler since you don't need <code>GenericSchema</code>. Make sure to use <code>Schema.gen</code> with the proper R type parameter.
To make sure Caliban uses the proper environment, you need to specify it explicitly to <code>graphQL(...)</code>, unless you already have <code>Schema</code> instances for your root operations in scope.</p> <div class="language-scala mdoc:silent extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> queries <span class="token operator">=</span> Queries<span class="token punctuation">(</span>ZIO<span class="token punctuation">.</span>attempt<span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _ <span class="token keyword">=&gt;</span> ZIO<span class="token punctuation">.</span>succeed<span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> api <span class="token operator">=</span> GraphQL<span class="token punctuation">.</span>graphQL<span class="token punctuation">[</span>MyEnv<span class="token punctuation">,</span> Queries<span class="token punctuation">,</span> <span class="token builtin">Unit</span><span class="token punctuation">,</span> <span class="token builtin">Unit</span><span class="token punctuation">]</span><span class="token punctuation">(</span>RootResolver<span class="token punctuation">(</span>queries<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// or</span>
<span class="token comment">// implicit val queriesSchema: Schema[MyEnv, Queries] = Schema.gen</span>
<span class="token comment">// val api = graphQL(RootResolver(queries)) // it will infer MyEnv thanks to the instance above</span>
</code></pre></div><h2 id="annotations"><a href="#annotations" class="header-anchor">#</a> Annotations</h2> <p>Caliban supports a few annotations to enrich data types:</p> <ul><li><code>@GQLName(&quot;name&quot;)</code> allows you to specify a different name for a data type or a field.</li> <li><code>@GQLInputName(&quot;name&quot;)</code> allows you to specify a different name for a data type used as an input (by default, the suffix <code>Input</code> is appended to the type name).</li> <li><code>@GQLDescription(&quot;description&quot;)</code> lets you provide a description for a data type or field. This description will be visible when your schema is introspected.</li> <li><code>@GQLDeprecated(&quot;reason&quot;)</code> allows deprecating a field or an enum value.</li> <li><code>@GQLExcluded</code> allows you to hide a field from the generated schema.</li> <li><code>@GQLInterface</code> to force a sealed trait generating an interface instead of a union.</li> <li><code>@GQLDirective(directive: Directive)</code> to add a directive to a field or type.</li> <li><code>@GQLValueType(isScalar)</code> forces a type to behave as a value type for derivation. Meaning that caliban will ignore the outer type and take the first case class parameter as the real type. If <code>isScalar</code> is true, it will generate a scalar named after the case class (default: false).</li> <li><code>@GQLDefault(&quot;defaultValue&quot;)</code> allows you to specify a default value for an input field using GraphQL syntax. The default value will be visible in your schema's SDL and during introspection.</li></ul> <h2 id="java-8-time-types"><a href="#java-8-time-types" class="header-anchor">#</a> Java 8 Time types</h2> <p>Caliban provides implicit <code>Schema</code> types for the standard <code>java.time</code> types, by default these will use the
ISO standard strings for serialization and deserialization. However, you can customize this behavior by using
explicit constructor available under the <code>ArgBuilder</code> companion object. For instance, you can specify an <code>instantEpoch</code>
to handle instants which are encoded using a <code>Long</code> from the standard java epoch time (January 1st 1970 00:00:00).
For some time formats you can also specify a specific <code>DateTimeFormatter</code> to handle your particular date time needs.</p> <h2 id="custom-types"><a href="#custom-types" class="header-anchor">#</a> Custom types</h2> <p>Caliban provides auto-derivation for common types such as <code>Int</code>, <code>String</code>, <code>List</code>, <code>Option</code>, etc. but you can also support your own types by providing an implicit instance of <code>caliban.schema.Schema</code>.</p> <p>An easy way to do this is to reuse existing instances and use <code>contramap</code> to map from your type to the original type. Here's an example of creating an instance for <a href="https://github.com/fthomas/refined" target="_blank" rel="noopener noreferrer">refined<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>'s <code>NonEmptyString</code> reusing existing instance for <code>String</code> (if you use <code>refined</code>, you might want to look at <a href="https://github.com/niqdev/caliban-extras#caliban-refined" target="_blank" rel="noopener noreferrer">caliban-refined<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>):</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span>schema<span class="token punctuation">.</span></span>_
<span class="token keyword">implicit</span> <span class="token keyword">val</span> nonEmptyStringSchema<span class="token operator">:</span> Schema<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">,</span> NonEmptyString<span class="token punctuation">]</span> <span class="token operator">=</span> Schema<span class="token punctuation">.</span>stringSchema<span class="token punctuation">.</span>contramap<span class="token punctuation">(</span>_<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre></div><p>You can also use the <code>scalarSchema</code> helper to create your own scalar types, providing a name, an optional description, and a function from your type to a <code>ResponseValue</code>:</p> <div class="language-scala mdoc:silent:reset extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span>schema<span class="token punctuation">.</span></span>_
<span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span></span>ResponseValue<span class="token punctuation">.</span>ObjectValue

<span class="token keyword">implicit</span> <span class="token keyword">val</span> unitSchema<span class="token operator">:</span> Schema<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">,</span> <span class="token builtin">Unit</span><span class="token punctuation">]</span> <span class="token operator">=</span> Schema<span class="token punctuation">.</span>scalarSchema<span class="token punctuation">(</span><span class="token string">&quot;Unit&quot;</span><span class="token punctuation">,</span> None<span class="token punctuation">,</span> None<span class="token punctuation">,</span> _ <span class="token keyword">=&gt;</span> ObjectValue<span class="token punctuation">(</span>Nil<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>If you are using a custom type as part of the input you also have to provide an implicit instance of <code>caliban.schema.ArgBuilder</code>. For example here's how to do that for <code>java.time.LocalDate</code>:</p> <div class="language-scala mdoc:silent extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span>LocalDate
<span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Try

<span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span></span>Value
<span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span></span>CalibanError<span class="token punctuation">.</span>ExecutionError
<span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span>schema<span class="token punctuation">.</span></span>ArgBuilder

<span class="token keyword">implicit</span> <span class="token keyword">val</span> localDateArgBuilder<span class="token operator">:</span> ArgBuilder<span class="token punctuation">[</span>LocalDate<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> Value<span class="token punctuation">.</span>StringValue<span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span>
    Try<span class="token punctuation">(</span>LocalDate<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>fold<span class="token punctuation">(</span>ex <span class="token keyword">=&gt;</span> Left<span class="token punctuation">(</span>ExecutionError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;Can't parse </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">value</span></span><span class="token string"> into a LocalDate&quot;</span></span><span class="token punctuation">,</span> innerThrowable <span class="token operator">=</span> Some<span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Right<span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">case</span> other <span class="token keyword">=&gt;</span> Left<span class="token punctuation">(</span>ExecutionError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;Can't build a LocalDate from input </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">other</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Value classes (<code>case class SomeWrapper(self: SomeType) extends AnyVal</code>) will be unwrapped by default in Scala 2 (this is not supported by Scala 3 derivation).</p> <h2 id="code-generation"><a href="#code-generation" class="header-anchor">#</a> Code generation</h2> <p>Caliban can automatically generate Scala code from a GraphQL schema.</p> <p>In order to use this feature, add the <code>caliban-codegen-sbt</code> sbt plugin to your <code>project/plugins.sbt</code> file:</p> <div class="language-scala extra-class"><pre class="language-scala"><code>addSbtPlugin<span class="token punctuation">(</span><span class="token string">&quot;com.github.ghostdogpr&quot;</span> <span class="token operator">%</span> <span class="token string">&quot;caliban-codegen-sbt&quot;</span> <span class="token operator">%</span> <span class="token string">&quot;2.0.1&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>And enable it in your <code>build.sbt</code> file:</p> <div class="language-scala extra-class"><pre class="language-scala"><code>enablePlugins<span class="token punctuation">(</span>CalibanPlugin<span class="token punctuation">)</span>
</code></pre></div><p>Then call the <code>calibanGenSchema</code> sbt command.</p> <div class="language-scala extra-class"><pre class="language-scala"><code>calibanGenSchema schemaPath outputPath <span class="token punctuation">[</span><span class="token operator">--</span>scalafmtPath path<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>headers name<span class="token operator">:</span>value<span class="token punctuation">,</span>name2<span class="token operator">:</span>value2<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>packageName name<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>effect fqdn<span class="token punctuation">.</span>Effect<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>scalarMappings gqlType<span class="token operator">:</span>f<span class="token punctuation">.</span>q<span class="token punctuation">.</span>d<span class="token punctuation">.</span>n<span class="token punctuation">.</span>Type<span class="token punctuation">,</span>gqlType2<span class="token operator">:</span>f<span class="token punctuation">.</span>q<span class="token punctuation">.</span>d<span class="token punctuation">.</span>n<span class="token punctuation">.</span>Type2<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>imports a<span class="token punctuation">.</span>b<span class="token punctuation">.</span>c<span class="token punctuation">.</span>_<span class="token punctuation">,</span>c<span class="token punctuation">.</span>d<span class="token punctuation">.</span>E<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">--</span>abstractEffectType <span class="token boolean">true</span><span class="token operator">|</span><span class="token boolean">false</span><span class="token punctuation">]</span>

calibanGenSchema project<span class="token operator">/</span>schema<span class="token punctuation">.</span>graphql src<span class="token operator">/</span>main<span class="token operator">/</span>MyAPI<span class="token punctuation">.</span>scala
</code></pre></div><p>This command will create a Scala file in <code>outputPath</code> containing all the types defined in the provided GraphQL schema defined at <code>schemaPath</code>. Instead of a file, you can provide a URL and the schema will be obtained using introspection.</p> <p>The generated code will be formatted with Scalafmt using the configuration defined by <code>--scalafmtPath</code> option (default: <code>.scalafmt.conf</code>). If you provide a URL for <code>schemaPath</code>, you can provide request headers with <code>--headers</code> option.</p> <p>The package of the generated code is derived from the folder of <code>outputPath</code>. This can be overridden by providing an alternative package with the <code>--packageName</code> option.</p> <p>By default, each Query and Mutation will be wrapped into a <code>zio.UIO</code> effect. This can be overridden by providing an alternative effect with the <code>--effect</code> option.</p> <p>You can also indicate that the effect type is abstract via <code>--abstractEffectType true</code>, in which case <code>Query</code> will be replaced by <code>Query[F[_]]</code> and so on (note <code>F</code> will be used unless <code>--effect &lt;effect&gt;</code> is explicitly given in which case <code>&lt;effect&gt;</code> would be used in place of <code>F</code>).</p> <p>By default the suffix <code>Input</code> is appended to the type name of input types in the derived schema.  Use the <code>--preserveInputNames</code> flag to disable this.</p> <p>If you want to force a mapping between a GraphQL type and a Scala class (such as scalars), you can use the
<code>--scalarMappings</code> option. Also you can add additional imports by providing <code>--imports</code> option.</p> <p>Since Caliban 1.3.0, you can generate schemas using an sbt <code>sourceGenerator</code>, which means your schemas will be generated every time you compile (or when you import your build into <a href="https://scalameta.org/metals/" target="_blank" rel="noopener noreferrer">Metals<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).
This can be configured with the same settings as <a href="/caliban/docs/client.html#code-generation">the client generators</a>, but you have to specify <code>.genType(Codegen.GenType.Schema)</code> in the <code>calibanSettings</code> entry for a given file.</p> <h2 id="building-schemas-by-hand"><a href="#building-schemas-by-hand" class="header-anchor">#</a> Building Schemas by hand</h2> <p>Sometimes for whatever reason schema generation fails. This can happen if your schema has co-recursive types and Magnolia is unable
to generate a schema for them. In cases like these you may need to instead create your own schema by hand.</p> <p>Consider the case where you have three types which create cyclical dependencies on one another</p> <div class="language-scala mdoc:silent extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>UUID
<span class="token keyword">import</span> <span class="token namespace">zio<span class="token punctuation">.</span></span>UIO

<span class="token keyword">case</span> <span class="token keyword">class</span> Group<span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> users<span class="token operator">:</span> UIO<span class="token punctuation">[</span>List<span class="token punctuation">[</span>User<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parent<span class="token operator">:</span> UIO<span class="token punctuation">[</span>Option<span class="token punctuation">[</span>Group<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> organization<span class="token operator">:</span> UIO<span class="token punctuation">[</span>Organization<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> Organization<span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> groups<span class="token operator">:</span> UIO<span class="token punctuation">[</span>List<span class="token punctuation">[</span>Group<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> User<span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> group<span class="token operator">:</span> UIO<span class="token punctuation">[</span>Group<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>These three types all depend on one another and if you attempt to generate a schema from them you will either end up with compiler errors or you will end up with a nasty runtime
error from a <code>NullPointerException</code>. To help the compiler out we can hand generate the types for these case classes instead.</p> <div class="language-scala mdoc:silent extra-class"><pre class="language-scala"><code><span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span>schema<span class="token punctuation">.</span></span>Schema
<span class="token keyword">import</span> <span class="token namespace">caliban<span class="token punctuation">.</span>schema<span class="token punctuation">.</span></span>Schema<span class="token punctuation">.</span><span class="token punctuation">{</span>obj<span class="token punctuation">,</span> field<span class="token punctuation">}</span>

<span class="token keyword">implicit</span> <span class="token keyword">lazy</span> <span class="token keyword">val</span> groupSchema<span class="token operator">:</span> Schema<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">,</span> Group<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">(</span><span class="token string">&quot;Group&quot;</span><span class="token punctuation">,</span> Some<span class="token punctuation">(</span><span class="token string">&quot;A group of users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>
  <span class="token keyword">implicit</span> ft <span class="token keyword">=&gt;</span>
    List<span class="token punctuation">(</span>
      field<span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
      field<span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>users<span class="token punctuation">)</span><span class="token punctuation">,</span>
      field<span class="token punctuation">(</span><span class="token string">&quot;parent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span>
      field<span class="token punctuation">(</span><span class="token string">&quot;organization&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>organization<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">implicit</span> <span class="token keyword">lazy</span> <span class="token keyword">val</span> orgSchema<span class="token operator">:</span> Schema<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">,</span> Organization<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">(</span><span class="token string">&quot;Organization&quot;</span><span class="token punctuation">,</span> Some<span class="token punctuation">(</span><span class="token string">&quot;An organization of groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>
  <span class="token keyword">implicit</span> ft <span class="token keyword">=&gt;</span>
    List<span class="token punctuation">(</span>
      field<span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
      field<span class="token punctuation">(</span><span class="token string">&quot;groups&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>groups<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">implicit</span> <span class="token keyword">lazy</span> <span class="token keyword">val</span> userSchema<span class="token operator">:</span> Schema<span class="token punctuation">[</span><span class="token builtin">Any</span><span class="token punctuation">,</span> User<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">(</span><span class="token string">&quot;User&quot;</span><span class="token punctuation">,</span> Some<span class="token punctuation">(</span><span class="token string">&quot;A user of the service&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>
  <span class="token keyword">implicit</span> ft <span class="token keyword">=&gt;</span>
    List<span class="token punctuation">(</span>
      field<span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
      field<span class="token punctuation">(</span><span class="token string">&quot;group&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span>group<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/caliban/docs/" class="prev router-link-active">
        Getting Started
      </a></span> <span class="next"><a href="/caliban/docs/middleware.html">
        Middleware
      </a>
      
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/caliban/assets/js/app.31e5e5cd.js" defer></script><script src="/caliban/assets/js/2.63c13255.js" defer></script><script src="/caliban/assets/js/23.2694ff67.js" defer></script>
  </body>
</html>

(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{305:function(e,a,t){"use strict";t.r(a);var n=t(14),s=Object(n.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"code-generation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#code-generation"}},[e._v("#")]),e._v(" Code Generation")]),e._v(" "),a("p",[e._v("Caliban provides two sbt plugins to generate your client(s) code.")]),e._v(" "),a("p",[e._v("The first one, named "),a("code",[e._v("CalibanPlugin")]),e._v(", allows you to generate the client code from a schema file or from a server URL, manually or automatically.")]),e._v(" "),a("p",[e._v("The second one, named "),a("code",[e._v("CompileTimeCalibanPlugin")]),e._v(', allows you to generate the client code from your server code.\nThis second "meta" plugin is actually made of two "concrete" plugins, '),a("code",[e._v("CompileTimeCalibanServerPlugin")]),e._v(" and "),a("code",[e._v("CompileTimeCalibanClientPlugin")]),e._v(", that you'll\nboth need to configure in your project to be able to generate you Caliban client code from your Caliban server code.")]),e._v(" "),a("p",[e._v("To use any of these two plugins, you'll first need to add following dependency to your "),a("code",[e._v("project/plugins.sbt")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[e._v("addSbtPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.github.ghostdogpr"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("%")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"caliban-codegen-sbt"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("%")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2.5.3"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("h2",{attrs:{id:"calibanplugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calibanplugin"}},[e._v("#")]),e._v(" CalibanPlugin")]),e._v(" "),a("p",[e._v("The first step for building GraphQL queries with "),a("code",[e._v("caliban-client")]),e._v(" is to generate boilerplate code from a GraphQL schema. For that, you need a file containing your schema (if your backend uses "),a("code",[e._v("caliban")]),e._v(", you can get it by calling "),a("code",[e._v("GraphQL#render")]),e._v(" on your API).")]),e._v(" "),a("p",[e._v("And enable it in your "),a("code",[e._v("build.sbt")]),e._v(" file:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[e._v("enablePlugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("CalibanPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("h3",{attrs:{id:"from-a-schema-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#from-a-schema-file"}},[e._v("#")]),e._v(" From a schema file")]),e._v(" "),a("p",[e._v("At this point, the "),a("code",[e._v("caliban")]),e._v(" command will cause any files in "),a("code",[e._v("src/main/graphql")]),e._v(" to be translated into a Caliban-generated client library. This happens automatically any time you "),a("code",[e._v("compile")]),e._v(".")]),e._v(" "),a("p",[e._v("By default, all clients are generated with the same client name as the source file, in the "),a("code",[e._v("caliban")]),e._v(" top-level package.")]),e._v(" "),a("p",[e._v("In order to supply more configuration options to the code generator, you can use the "),a("code",[e._v("calibanSettings")]),e._v(" sbt setting, combined with the "),a("code",[e._v("calibanSetting")]),e._v(" function to scope the settings to a particular file:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[e._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('// The `file("Service.graphql")` is a path suffix for some file in `src/main/graphql`')]),e._v("\n      Compile "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" caliban "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" calibanSettings "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("+=")]),e._v(" calibanSetting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Service.graphql"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n        cs "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("=>")]),e._v("\n          cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("packageName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.example.graphql.client"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("scalarMapping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n              "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"LanguageCode"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("->")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.example.models.LanguageCode"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("scalarMapping"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n              "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Timestamp"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("->")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"java.sql.Timestamp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n              "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"DayOfWeek"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("->")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"java.time.DayOfWeek"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n              "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"IntRange"')]),e._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("->")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.github.tminglei.slickpg.Range[Int]"')]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("imports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.example.graphql.client.implicits._"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v("The path where the generator will look for schemas can be customized by overriding the "),a("code",[e._v("calibanSources")]),e._v(" settings:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[e._v("Compile "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" caliban "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" calibanSources "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"caliban"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v("If you want to cherry-pick certain files yourself, you can override that as well with an explicit "),a("code",[e._v("caliban / sources")]),e._v(" entry:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[e._v("Compile "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" caliban "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" sources "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" List"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"caliban"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Service.graphql"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v("For every entry in "),a("code",[e._v("calibanSettings")]),e._v(" for the same file, a separate client (or "),a("RouterLink",{attrs:{to:"/docs/schema.html#code-generation"}},[e._v("schema")]),e._v(", depending on the entry's "),a("code",[e._v("genType")]),e._v(" value) will be generated.")],1),e._v(" "),a("h3",{attrs:{id:"from-a-server-url"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#from-a-server-url"}},[e._v("#")]),e._v(" From a server URL")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("calibanSetting")]),e._v(" function also permits generating clients for supplied "),a("code",[e._v("url")]),e._v("'s:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[e._v("      Compile "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" caliban "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" calibanSettings "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("+=")]),e._v(" calibanSetting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"http://my-example-service/graphql"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n        cs "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("=>")]),e._v("\n          cs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("clientName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"ExampleServiceClient"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("packageName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.example.graphql.client"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("h3",{attrs:{id:"generation-settings"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generation-settings"}},[e._v("#")]),e._v(" Generation settings")]),e._v(" "),a("p",[e._v("The settings available on the "),a("code",[e._v("cs")]),e._v(" ("),a("code",[e._v("CalibanSettings")]),e._v(") builder are:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("packageName")]),e._v(": The package in which the code will be generated (default: "),a("code",[e._v("caliban")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("scalafmtPath")]),e._v(": Path to a scalafmt config file (default: "),a("code",[e._v(".scalafmt.conf")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("genView")]),e._v(": If true, will generate a case class and helper method to select all fields on an object (default: "),a("code",[e._v("false")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("scalarMappings")]),e._v(": A mapping from GraphQL scalar types to JVM types, as unknown scalar types are represented as "),a("code",[e._v("String")]),e._v(" by default.")]),e._v(" "),a("li",[a("code",[e._v("imports")]),e._v(": A list of imports to be added at the top of the generated code.")]),e._v(" "),a("li",[a("code",[e._v("splitFiles")]),e._v(": Whether to split the generated code into multiple files (default: "),a("code",[e._v("false")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("enableFmt")]),e._v(": Enable code formatting with scalafmt (default: "),a("code",[e._v("true")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("extensibleEnums")]),e._v(": Generate a fallback case class for unknown enum values (default: "),a("code",[e._v("false")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("headers")]),e._v(" (only defined for "),a("code",[e._v("url")]),e._v(" settings): Supply extra headers when fetching the schema from a URL.")])]),e._v(" "),a("h3",{attrs:{id:"manual-generation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#manual-generation"}},[e._v("#")]),e._v(" Manual generation")]),e._v(" "),a("p",[e._v("If you prefer to generate the client explicitly rather than automatically, you can use "),a("code",[e._v("calibanGenClient")]),e._v(" on the SBT CLI as follows:")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("calibanGenClient schemaPath outputPath "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("--scalafmtPath path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("--headers name:value,name2:value2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("--genView "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("--scalarMappings gqlType:f.q.d.n.Type,gqlType2:f.q.d.n.Type2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("--imports a.b.c._,c.d.E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("--splitFiles "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("--enableFmt "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# example")]),e._v("\ncalibanGenClient project/schema.graphql src/main/client/Client.scala "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("--genView")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("  \n")])])]),a("p",[e._v("This command will generate a Scala file in "),a("code",[e._v("outputPath")]),e._v(" containing helper functions for all the types defined in the provided GraphQL schema defined at "),a("code",[e._v("schemaPath")]),e._v(".")]),e._v(" "),a("p",[e._v("If you need to disable generating clients from "),a("code",[e._v("src/main/graphql")]),e._v(", include "),a("code",[e._v("Compile / caliban / calibanGenerator := Seq.empty")]),e._v(" in your project settings.")]),e._v(" "),a("p",[e._v("The package of the generated code is derived from the folder of "),a("code",[e._v("outputPath")]),e._v(". This can be overridden by providing an alternative package with the "),a("code",[e._v("--packageName")]),e._v(" option.\nSimilarly, the generated object name is derived from "),a("code",[e._v("outputPath")]),e._v(" file name but can be overridden with the "),a("code",[e._v("--clientName")]),e._v(" option.")]),e._v(" "),a("p",[e._v("Other options are explained above.")]),e._v(" "),a("h2",{attrs:{id:"compiletimecalibanplugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compiletimecalibanplugin"}},[e._v("#")]),e._v(" CompileTimeCalibanPlugin")]),e._v(" "),a("p",[e._v("As mentioned in the introduction of the "),a("a",{attrs:{href:"#code-generation"}},[e._v("Code Generation")]),e._v(' chapter, this "meta" plugin is actually made of two "concrete" sbt plugins, '),a("code",[e._v("CompileTimeCalibanServerPlugin")]),e._v(" and "),a("code",[e._v("CompileTimeCalibanClientPlugin")]),e._v(",\nthat you'll both need to configure in your project be able to generate your Caliban client code from your Caliban server code..")]),e._v(" "),a("p",[e._v("You can find a demo project using this plugin here: "),a("a",{attrs:{href:"https://github.com/guizmaii/poc_compile_time_caliban_client_generation",target:"_blank",rel:"noopener noreferrer"}},[e._v("Demo project"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("To generate the Caliban client code from you Caliban server code, you need to do two things:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Tell to the plugin where your Caliban "),a("code",[e._v("GraphQL[R]")]),e._v(" instances for which you want to generate a client are and configure the client code generator."),a("br"),e._v("\nHow to configure this is explained in the following "),a("a",{attrs:{href:"#server-side-configuration"}},[e._v("Server side configuration")]),e._v(" chapter.")])]),e._v(" "),a("li",[a("p",[e._v("Tell to the plugin where you want to generate your client(s)."),a("br"),e._v("\nHow to configure this is explained in the following "),a("a",{attrs:{href:"#client-side-configuration"}},[e._v("Client side configuration")]),e._v(" chapter.")])])]),e._v(" "),a("h3",{attrs:{id:"server-side-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#server-side-configuration"}},[e._v("#")]),e._v(" Server side configuration")]),e._v(" "),a("p",[e._v("First, you'll need to activate the "),a("code",[e._v("CompileTimeCalibanServerPlugin")]),e._v(" plugin in all the sbt modules of your project containing a "),a("code",[e._v("GraphQL[R]")]),e._v(" instance for which you want to generate a client.")]),e._v(" "),a("p",[e._v("Let's say you have an "),a("code",[e._v("api")]),e._v(" sbt module defined in your "),a("code",[e._v("build.sbt")]),e._v(" which contains your Caliban server code:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("lazy")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("val")]),e._v(" api "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n  project\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("enablePlugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("CompileTimeCalibanServerPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v('Now, you need to tell to the "server side" plugin where is your '),a("code",[e._v("GraphQL[R]")]),e._v(" instance for which you want to generate a client."),a("br"),e._v("\nThis "),a("code",[e._v("GraphQL[R]")]),e._v(" instance need to be "),a("code",[e._v("public")]),e._v(". If it's "),a("code",[e._v("private")]),e._v(" or "),a("code",[e._v("protected")]),e._v(", the plugin code generator will not have access to it and will fail.")]),e._v(" "),a("p",[e._v("Let's say you have an object "),a("code",[e._v("CalibanServer")]),e._v(" object in your "),a("code",[e._v("api")]),e._v(" sbt module:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("package")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("example"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("my"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("awesome"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("project"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("api")]),e._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[e._v("caliban"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")])]),e._v("_\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("object")]),e._v(" CalibanServer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("val")]),e._v(" graphqlApi"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" GraphQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("MyEnv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" graphQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("Resolvers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("resolver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("You'll need to add in your sbt definition:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("lazy")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("val")]),e._v(" api "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n  project\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("enablePlugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("CompileTimeCalibanServerPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n      Compile "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanServer "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanServerSettings "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n        Seq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.example.my.awesome.project.api.CalibanServer.graphqlApi"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("->")]),e._v(" ClientGenerationSettings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("default\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v('This is the minimal working configuration for the "server side".')]),e._v(" "),a("p",[e._v("Now, you may want to tweak how the client code is generated."),a("br"),e._v("\nFor that, you'll have to replace the "),a("code",[e._v("ClientGenerationSettings.default")]),e._v(" with the configuration that suits you the best."),a("br"),e._v("\nThis "),a("code",[e._v("ClientGenerationSettings")]),e._v(" case class gives you the following configuration options:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("packageName")]),e._v(": The package in which the code will be generated (default: "),a("code",[e._v("generated")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("clientName")]),e._v(": The name of the client class generated (default: "),a("code",[e._v("Client")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("scalafmtPath")]),e._v(": Path to a scalafmt config file (default: "),a("code",[e._v(".scalafmt.conf")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("genView")]),e._v(": If true, will generate a case class and helper method to select all fields on an object (default: "),a("code",[e._v("false")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("scalarMappings")]),e._v(": A mapping from GraphQL scalar types to JVM types, as unknown scalar types are represented as "),a("code",[e._v("String")]),e._v(" by default.")]),e._v(" "),a("li",[a("code",[e._v("imports")]),e._v(": A list of imports to be added at the top of the generated code.")]),e._v(" "),a("li",[a("code",[e._v("splitFiles")]),e._v(": Whether to split the generated code into multiple files (default: "),a("code",[e._v("false")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("enableFmt")]),e._v(": Enable code formatting with scalafmt (default: "),a("code",[e._v("true")]),e._v(").")]),e._v(" "),a("li",[a("code",[e._v("extensibleEnums")]),e._v(": Generate a fallback case class for unknown enum values (default: "),a("code",[e._v("false")]),e._v(").")])]),e._v(" "),a("p",[e._v("Let's take an example:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("lazy")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("val")]),e._v(" api "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n  project\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("enablePlugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("CompileTimeCalibanServerPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n      Compile "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanServer "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanServerSettings "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n        Seq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.example.my.awesome.project.api.CalibanServer.graphqlApi"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("->")]),e._v("\n            ClientGenerationSettings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n              packageName "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"com.example.my.awesome.project.client.generated"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n              clientName "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"CalibanClient"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n              splitFiles "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v('That\'s all. You now know how to configure the "server side" of this plugin.'),a("br"),e._v('\nLet\'s now see how to configure the "client side".')]),e._v(" "),a("h3",{attrs:{id:"client-side-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#client-side-configuration"}},[e._v("#")]),e._v(" Client side configuration")]),e._v(" "),a("p",[e._v('The "client side" of this plugin is here to help you define where your Caliban client code is generated.')]),e._v(" "),a("p",[e._v("The first thing to do is to activate the "),a("code",[e._v("CompileTimeCalibanClientPlugin")]),e._v(" in the sbt module where you want your Caliban client code to be generated into.")]),e._v(" "),a("p",[e._v("Let's say you have a "),a("code",[e._v("client")]),e._v(" sbt module defined in your "),a("code",[e._v("build.sbt")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("lazy")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("val")]),e._v(" client "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n  project\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("enablePlugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("CompileTimeCalibanClientPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v("You only have one thing left to do."),a("br"),e._v('\nYou need to reference your "server side" sbt module (here '),a("code",[e._v("api")]),e._v(') in your "client side" sbt module (here '),a("code",[e._v("client")]),e._v(") definition so the plugin knows that you want to generate the Caliban client code for your "),a("code",[e._v("api")]),e._v(" server\nin this "),a("code",[e._v("client")]),e._v(" sbt module:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("lazy")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("val")]),e._v(" client "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n  project\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("enablePlugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("CompileTimeCalibanClientPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n      Compile "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanClient "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanClientsSettings "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Seq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v('This is the minimal working configuration for the "client side".')]),e._v(" "),a("p",[e._v("By default, the Caliban client code will be generated in your "),a("code",[e._v("src/main/scala")]),e._v(" directory of your "),a("code",[e._v("client")]),e._v(" sbt module."),a("br"),e._v("\nYou may prefer it not to be generated inside your - usually versioned-in-git - module code.\nFor that, the plugin provides an option to generate the code in the "),a("code",[e._v("target")]),e._v(" directory instead:")]),e._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("lazy")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("val")]),e._v(" client "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n  project\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("enablePlugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("CompileTimeCalibanClientPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("settings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n      Compile "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanClient "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanClientsSettings "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Seq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      Compile "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanClient "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" ctCalibanClientsVersionedCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// By default, it's true.")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),a("p",[e._v("You're done. 🎉"),a("br"),e._v("\nYou can now reload your sbt config and recompile your project. Your Caliban client code will be generated during the compilation process.")]),e._v(" "),a("h3",{attrs:{id:"additional-information-about-compiletimecalibanplugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#additional-information-about-compiletimecalibanplugin"}},[e._v("#")]),e._v(" Additional information about CompileTimeCalibanPlugin")]),e._v(" "),a("p",[e._v("As you may have seen in the "),a("a",{attrs:{href:"https://github.com/guizmaii/poc_compile_time_caliban_client_generation",target:"_blank",rel:"noopener noreferrer"}},[e._v("demo project"),a("OutboundLink")],1),e._v(", you can have more complex configurations for this plugin."),a("br"),e._v("\nYou can have more than one "),a("code",[e._v("GraphQL[R]")]),e._v(" instance per server. Each "),a("code",[e._v("GraphQL[R]")]),e._v(" instance can have its own client code generation configuration."),a("br"),e._v('\nYou can also have multiple "servers" referenced in your "client" module. The plugin will generate all the clients for all the "servers" referenced in your sbt definition.')])])}),[],!1,null,null,null);a.default=s.exports}}]);